---
import { Image } from 'astro:assets';
import BaseLayout from './BaseLayout.astro';
import '@/styles/global.css';

interface Props {
  frontmatter: {
    cover: string;
    coverAlt: string;
    title: string;
    publishedDate: Date;
    readingTime: number;
    description: string;
  };
}

const { frontmatter } = Astro.props;

const images = import.meta.glob<{ default: ImageMetadata }>(
  '/src/assets/blog/*.{jpeg,jpg,png,gif}',
);

if (!images[frontmatter.cover]) {
  throw new Error(
    `"${frontmatter.cover}" does not exist in glob: "/src/assets/blog/*.{jpeg,jpg,png,gif}"`,
  );
}

const cover = images[frontmatter.cover]();
---

<BaseLayout>
  <section class="container mx-auto max-w-7xl px-6 py-8">
    <h1 class="text-4xl font-bold">{frontmatter.title}</h1>
    <Image src={cover} alt={frontmatter.coverAlt} class="w-full" />
    <div class="prose">
      <slot />
    </div>
  </section>
</BaseLayout>
